# 线程注入技术 + IAT HOOK

## 1 实验要求

API hook的方式进行

- hook writefile 要先调用createfile，如果我们要把写入的haha改为hehe，要hookwritefile，不要hook messagebox
- 把writefile的功能，写成dll，把这个dll注入到notepad的进程中，不能是自己的进程

- findfirstfilenext ？？？ 改的程序注入到cmd，输入回车dir，dir的结果中出现hacker.exe就抹掉，不让他出现，实现文件的隐藏，无法遍历该文件？？

- 遍历进程的方法，taskmanager/tasklist 遍历不到hacker.exe这个进程

- hook textout的函数 setwindowtext 
    - 不改输出，但是可以记录输出，屏幕取词（金山词霸、有道词典）鼠标悬停在单词上

- 接管其他进程的键盘输入，微信进程的文本框输入读取出来

**线程注入技术和IAT HOOK综合运用，实现对系统中进程的修改**

## 2 实验环境

- Visual Studio 2019 
  - 选择`Debug x86`
- 选择32位 Notepad ，位于路径`C:\Windows\SysWOW64`
  - ~不要被名字迷惑~
  - 64位 Notepad 位于路径`C:\Windows\System32`

## 3 实验原理

- IAT HOOK
  - IAT
- API HOOK

## 4 实验过程

## 5 实验总结

## 6 参考资料